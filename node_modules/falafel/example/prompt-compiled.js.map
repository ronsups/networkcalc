{"version":3,"sources":["prompt.js"],"names":[],"mappings":";;AAAA,IAAI,UAAU,QAAQ,KAAR,CAAd;AACA,IAAI,KAAK,QAAQ,IAAR,CAAT;;AAEA,IAAI,WAAW,CACX,YADW,EAEX,gBAFW,EAGX,kBAHW,EAIX,kBAJW,EAKX,iBALW,EAMb,MANa,CAMN,UAAU,GAAV,EAAe,GAAf,EAAoB;AAAE,QAAI,GAAJ,IAAW,IAAX,CAAiB,OAAO,GAAP;AAAY,CAN7C,EAM+C,EAN/C,CAAf;;AAQA,SAAS,UAAT,CAAqB,IAArB,EAA2B;AACvB,SAAK,IAAI,IAAI,IAAb,EAAmB,EAAE,MAArB,EAA6B,IAAI,EAAE,MAAnC,EAA2C;AACvC,YAAI,SAAS,EAAE,IAAX,CAAJ,EAAsB,OAAO,IAAP;AACzB;AACD,WAAO,KAAP;AACH;;AAED,IAAI,MAAM,0DAAV;;AAEA,IAAI,UAAU,EAAd;AACA,IAAI,SAAS,QAAQ,MAAM,GAAN,GAAY,GAApB,EAAyB,UAAU,IAAV,EAAgB;AAClD,QAAI,SAAS,KAAK,MAAL,IACN,CAAC,WAAW,KAAK,MAAhB,CADK,IACsB,WAAW,IAAX,CADnC;;AAIA,QAAI,MAAJ,EAAY;AACR,YAAI,IAAI,KAAK,MAAL,EAAR;AACA,YAAI,WAAW,KAAf;AACA,YAAI,MAAM,GAAG,eAAH,CAAmB,MAAM,CAAN,GAAU,GAA7B,EAAkC;AACxC,oBAAS,gBAAU,CAAV,EAAa;AAClB,2BAAW,YAAY;AACnB,yBAAK,MAAL,CAAY,EAAE,WAAF,EAAZ;AACH,iBAFD,EAEG,KAAK,MAAL,KAAgB,EAFnB;AAGA,2BAAW,IAAX;AACH;AANuC,SAAlC,CAAV;AAQA,YAAI,CAAC,QAAL,EAAe;AACX,gBAAI,KAAK,KAAK,SAAL,CAAe,GAAf,CAAT;AACA,iBAAK,MAAL,CAAY,EAAZ;AACH;AACJ;AACJ,CArBY,CAAb;;AAuBA,WAAW,YAAY;AACnB,YAAQ,GAAR,CAAY,GAAZ;AACA,YAAQ,GAAR,CAAY,KAAZ;AACA,YAAQ,GAAR,CAAY,MAAZ;AACH,CAJD,EAIG,GAJH","file":"prompt-compiled.js","sourcesContent":["var falafel = require('../');\nvar vm = require('vm');\n\nvar termExps = [\n    'Identifier',\n    'CallExpression',\n    'BinaryExpression',\n    'UpdateExpression',\n    'UnaryExpression'\n].reduce(function (acc, key) { acc[key] = true; return acc }, {});\n\nfunction terminated (node) {\n    for (var p = node; p.parent; p = p.parent) {\n        if (termExps[p.type]) return true;\n    }\n    return false;\n}\n\nvar src = '{\"a\":[2,~9,prompt(\":d\")],\"b\":4,\"c\":prompt(\"beep\"),\"d\":6}';\n\nvar offsets = [];\nvar output = falafel('(' + src + ')', function (node) {\n    var isLeaf = node.parent\n        && !terminated(node.parent) && terminated(node)\n    ;\n    \n    if (isLeaf) {\n        var s = node.source();\n        var prompted = false;\n        var res = vm.runInNewContext('(' + s + ')', {\n            prompt : function (x) {\n                setTimeout(function () {\n                    node.update(x.toUpperCase());\n                }, Math.random() * 50);\n                prompted = true;\n            }\n        });\n        if (!prompted) {\n            var s_ = JSON.stringify(res);\n            node.update(s_);\n        }\n    }\n});\n\nsetTimeout(function () {\n    console.log(src);\n    console.log('---');\n    console.log(output);\n}, 200);\n"]}