{"version":3,"sources":["resolver.js"],"names":[],"mappings":"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","file":"resolver-compiled.js","sourcesContent":["var path = require('path');\nvar test = require('tape');\nvar resolve = require('../');\n\ntest('async foo', function (t) {\n    t.plan(9);\n    var dir = __dirname + '/resolver';\n    \n    resolve('./foo', { basedir : dir }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/foo.js');\n        t.equal(pkg.name, 'resolve');\n    });\n    \n    resolve('./foo.js', { basedir : dir }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/foo.js');\n        t.equal(pkg.name, 'resolve');\n    });\n    \n    resolve('./foo', { basedir : dir, package: { main: 'resolver' } }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/foo.js');\n        t.equal(pkg.main, 'resolver');\n    });\n    \n    resolve('./foo.js', { basedir : dir, package: { main: 'resolver' } }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/foo.js');\n        t.equal(pkg.main, 'resolver');\n    });\n    \n    resolve('foo', { basedir : dir }, function (err) {\n        t.equal(err.message, \"Cannot find module 'foo' from '\" + path.resolve(dir) + \"'\");\n    });\n});\n\ntest('bar', function (t) {\n    t.plan(6);\n    var dir = __dirname + '/resolver';\n    \n    resolve('foo', { basedir : dir + '/bar' }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/bar/node_modules/foo/index.js');\n        t.equal(pkg, undefined);\n    });\n    \n    resolve('foo', { basedir : dir + '/bar' }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/bar/node_modules/foo/index.js');\n        t.equal(pkg, undefined);\n    });\n    \n    resolve('foo', { basedir : dir + '/bar', package: { main: 'bar' } }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/bar/node_modules/foo/index.js');\n        t.equal(pkg, undefined);\n    });\n});\n\ntest('baz', function (t) {\n    t.plan(4);\n    var dir = __dirname + '/resolver';\n    \n    resolve('./baz', { basedir : dir }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/baz/quux.js');\n        t.equal(pkg.main, 'quux.js');\n    });\n    \n    resolve('./baz', { basedir : dir, package: { main: 'resolver' } }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/baz/quux.js');\n        t.equal(pkg.main, 'quux.js');\n    });\n});\n\ntest('biz', function (t) {\n    t.plan(24);\n    var dir = __dirname + '/resolver/biz/node_modules';\n    \n    resolve('./grux', { basedir : dir }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/grux/index.js');\n        t.equal(pkg, undefined);\n    });\n    \n    resolve('./grux', { basedir : dir, package: { main: 'biz' } }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/grux/index.js');\n        t.equal(pkg.main, 'biz');\n    });\n    \n    resolve('./garply', { basedir : dir }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/garply/lib/index.js');\n        t.equal(pkg.main, './lib');\n    });\n    \n    resolve('./garply', { basedir : dir, package: { main: 'biz' } }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/garply/lib/index.js');\n        t.equal(pkg.main, './lib');\n    });\n    \n    resolve('tiv', { basedir : dir + '/grux' }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/tiv/index.js');\n        t.equal(pkg, undefined);\n    });\n    \n    resolve('tiv', { basedir : dir + '/grux', package: { main: 'grux' } }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/tiv/index.js');\n        t.equal(pkg, undefined);\n    });\n    \n    resolve('tiv', { basedir : dir + '/garply' }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/tiv/index.js');\n        t.equal(pkg, undefined);\n    });\n    \n    resolve('tiv', { basedir : dir + '/garply', package: { main: './lib' } }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/tiv/index.js');\n        t.equal(pkg, undefined);\n    });\n    \n    resolve('grux', { basedir : dir + '/tiv' }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/grux/index.js');\n        t.equal(pkg, undefined);\n    });\n    \n    resolve('grux', { basedir : dir + '/tiv', package: { main: 'tiv' }  }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/grux/index.js');\n        t.equal(pkg, undefined);\n    });\n    \n    resolve('garply', { basedir : dir + '/tiv' }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/garply/lib/index.js');\n        t.equal(pkg.main, './lib');\n    });\n    \n    resolve('garply', { basedir : dir + '/tiv', package: { main: 'tiv' } }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/garply/lib/index.js');\n        t.equal(pkg.main, './lib');\n    });\n});\n\ntest('quux', function (t) {\n    t.plan(2);\n    var dir = __dirname + '/resolver/quux';\n    \n    resolve('./foo', { basedir : dir, package: { main: 'quux' } }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/foo/index.js');\n        t.equal(pkg.main, 'quux');\n    });\n});\n\ntest('normalize', function (t) {\n    t.plan(2);\n    var dir = __dirname + '/resolver/biz/node_modules/grux';\n    \n    resolve('../grux', { basedir : dir }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/index.js');\n        t.equal(pkg, undefined);\n    });\n});\n\ntest('cup', function (t) {\n    t.plan(3);\n    var dir = __dirname + '/resolver';\n    \n    resolve('./cup', { basedir : dir, extensions : [ '.js', '.coffee' ] },\n    function (err, res) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/cup.coffee');\n    });\n    \n    resolve('./cup.coffee', { basedir : dir }, function (err, res) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/cup.coffee');\n    });\n    \n    resolve('./cup', { basedir : dir, extensions : [ '.js' ] },\n    function (err, res) {\n        t.equal(err.message, \"Cannot find module './cup' from '\" + path.resolve(dir) + \"'\");\n    });\n});\n\ntest('mug', function (t) {\n    t.plan(3);\n    var dir = __dirname + '/resolver';\n    \n    resolve('./mug', { basedir : dir }, function (err, res) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/mug.js');\n    });\n    \n    resolve('./mug', { basedir : dir, extensions : [ '.coffee', '.js' ] },\n    function (err, res) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/mug.coffee');\n    });\n    \n    resolve('./mug', { basedir : dir, extensions : [ '.js', '.coffee' ] },\n    function (err, res) {\n        t.equal(res, dir + '/mug.js');\n    });\n});\n\ntest('other path', function (t) {\n    t.plan(4);\n    var resolverDir = __dirname + '/resolver';\n    var dir = resolverDir + '/bar';\n    var otherDir = resolverDir + '/other_path';\n    \n    resolve('root', { basedir : dir, paths: [otherDir] }, function (err, res) {\n        if (err) t.fail(err);\n        t.equal(res, resolverDir + '/other_path/root.js');\n    });\n    \n    resolve('lib/other-lib', { basedir : dir, paths: [otherDir] },\n    function (err, res) {\n        if (err) t.fail(err);\n        t.equal(res, resolverDir + '/other_path/lib/other-lib.js');\n    });\n    \n    resolve('root', { basedir : dir, }, function (err, res) {\n        t.equal(err.message, \"Cannot find module 'root' from '\" + path.resolve(dir) + \"'\");\n    });\n    \n    resolve('zzz', { basedir : dir, paths: [otherDir] }, function (err, res) {\n        t.equal(err.message, \"Cannot find module 'zzz' from '\" + path.resolve(dir) + \"'\");\n    });\n});\n\ntest('incorrect main', function (t) {\n    t.plan(1)\n\n    var resolverDir = __dirname + '/resolver';\n    var dir = resolverDir + '/incorrect_main';\n\n    resolve('./incorrect_main', { basedir : resolverDir }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, dir + '/index.js');\n    });\n});\n\ntest('without basedir', function (t) {\n    t.plan(1);\n\n    var dir = __dirname + '/resolver/without_basedir';\n    var tester = require(dir + '/main.js');\n\n    tester(t, function (err, res, pkg){\n        if (err) {\n\t  t.fail(err);\n\t} else {\n          t.equal(res, dir + '/node_modules/mymodule.js');\n\t}\n    });\n});\n\ntest('#25: node modules with the same name as node stdlib modules', function (t) {\n    t.plan(1);\n\n    var resolverDir = __dirname + '/resolver/punycode';\n\n    resolve('punycode', { basedir : resolverDir }, function (err, res, pkg) {\n        if (err) t.fail(err);\n        t.equal(res, resolverDir + '/node_modules/punycode/index.js');\n    });\n});\n"]}