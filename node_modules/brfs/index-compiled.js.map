{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;AAAA,IAAI,eAAe,QAAQ,eAAR,CAAnB;AACA,IAAI,QAAQ,QAAQ,cAAR,CAAZ;AACA,IAAI,UAAU,QAAQ,UAAR,CAAd;AACA,IAAI,KAAK,QAAQ,IAAR,CAAT;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,UAAU,QAAQ,SAAR,CAAd;;AAEA,OAAO,OAAP,GAAiB,UAAU,IAAV,EAAgB,IAAhB,EAAsB;AACnC,QAAI,UAAU,IAAV,CAAe,IAAf,CAAJ,EAA0B,OAAO,SAAP;;AAE1B,aAAS,QAAT,CAAmB,CAAnB,EAAsB;AAClB,eAAO,QAAQ,IAAR,CAAa,CAAb,EAAgB,EAAE,SAAS,KAAK,OAAL,CAAa,IAAb,CAAX,EAAhB,CAAP;AACH;AACD,QAAI,OAAO;AACP,oBAAY,IADL;AAEP,mBAAW,KAAK,OAAL,CAAa,IAAb,CAFJ;AAGP,iBAAS,EAAE,SAAS,QAAX;AAHF,KAAX;AAKA,QAAI,CAAC,IAAL,EAAW,OAAO,EAAP;AACX,QAAI,KAAK,IAAT,EAAe,OAAO,IAAP,CAAY,KAAK,IAAjB,EAAuB,OAAvB,CAA+B,UAAU,GAAV,EAAe;AACzD,aAAK,GAAL,IAAY,KAAK,IAAL,CAAU,GAAV,CAAZ;AACH,KAFc;;AAIf,QAAI,KAAK,aACL;AACI,YAAI;AACA,0BAAc,YADd;AAEA,sBAAU,QAFV;AAGA,yBAAa,WAHb;AAIA,qBAAS;AAJT;AADR,KADK,EASL,EAAE,MAAM,IAAR,EAAc,YAAY,EAAE,MAAM,IAAR,EAA1B,EATK,CAAT;AAWA,WAAO,EAAP;;AAEA,aAAS,QAAT,CAAmB,IAAnB,EAAyB,GAAzB,EAA8B,EAA9B,EAAkC;AAC9B,YAAI,OAAO,GAAP,KAAe,UAAnB,EAA+B;AAC3B,iBAAK,GAAL;AACA,kBAAM,IAAN;AACH;AACD,YAAI,OAAO,QAAO,GAAP,yCAAO,GAAP,OAAe,QAAtB,IAAkC,IAAI,QAA1C,EAAoD;AAChD,kBAAM,IAAI,QAAV;AACH;AACD,YAAI,WAAW,KAAf;AACA,YAAI,QAAQ,IAAR,IAAgB,QAAQ,SAA5B,EAAuC;AACnC,uBAAW,IAAX;AACA,kBAAM,QAAN;AACH;;AAED,YAAI,SAAS,QAAQ,KAAR,EAAe,GAAf,CAAb;AACA,eAAO,IAAP,CAAY,kCAAkC,EAAlC,GAAuC,SAAnD;AACA,YAAI,QAAJ,EAAc,OAAO,IAAP,CAAY,SAAZ;;AAEd,YAAI,IAAI,GAAG,gBAAH,CAAoB,IAApB,EAA0B,EAAE,UAAU,GAAZ,EAA1B,CAAR;AACA,UAAE,EAAF,CAAK,OAAL,EAAc,UAAU,GAAV,EAAe;AAAE,eAAG,IAAH,CAAQ,OAAR,EAAiB,GAAjB;AAAuB,SAAtD;AACA,eAAO,EAAE,IAAF,CAAO,OAAP,EAAgB,IAAhB,CAAqB,MAArB,CAAP;;AAEA,iBAAS,KAAT,CAAgB,GAAhB,EAAqB,GAArB,EAA0B,IAA1B,EAAgC;AAC5B,iBAAK,IAAL,CAAU,GAAV;AACA;AACH;AACD,iBAAS,GAAT,CAAc,IAAd,EAAoB;AAChB,gBAAI,QAAJ,EAAc,KAAK,IAAL,CAAU,YAAV;AACd,iBAAK,IAAL,CAAU,KAAV;AACA,iBAAK,IAAL,CAAU,IAAV;AACA,eAAG,IAAH,CAAQ,MAAR,EAAgB,IAAhB;AACA;AACH;AACJ;;AAED,aAAS,YAAT,CAAuB,IAAvB,EAA6B,GAA7B,EAAkC;AAC9B,YAAI,WAAW,KAAf;AACA,YAAI,QAAQ,IAAR,IAAgB,QAAQ,SAA5B,EAAuC;AACnC,uBAAW,IAAX;AACA,kBAAM,QAAN;AACH;AACD,YAAI,OAAO,QAAO,GAAP,yCAAO,GAAP,OAAe,QAAtB,IAAkC,IAAI,QAA1C,EAAoD;AAChD,kBAAM,IAAI,QAAV;AACH;AACD,YAAI,SAAS,GAAG,gBAAH,CAAoB,IAApB,EAA2B,EAAE,UAAU,GAAZ,EAA3B,EACR,EADQ,CACL,OADK,EACI,UAAU,GAAV,EAAe;AAAE,eAAG,IAAH,CAAQ,OAAR,EAAiB,GAAjB;AAAuB,SAD5C,EAER,IAFQ,CAEH,OAFG,EAEM,IAFN,CAEW,QAAQ,KAAR,EAAe,GAAf,CAFX,CAAb;AAIA,YAAI,QAAJ,EAAc;AACV,mBAAO,IAAP,CAAY,SAAZ;AACH;AACD,eAAO,MAAP;;AAEA,iBAAS,KAAT,CAAgB,GAAhB,EAAqB,GAArB,EAA0B,IAA1B,EAAgC;AAC5B,iBAAK,IAAL,CAAU,GAAV;AACA;AACH;AACD,iBAAS,GAAT,CAAc,IAAd,EAAoB;AAChB,gBAAI,QAAJ,EAAc,KAAK,IAAL,CAAU,YAAV;AACd,iBAAK,IAAL,CAAU,IAAV;AACA,eAAG,IAAH,CAAQ,MAAR,EAAgB,IAAhB;AACA;AACH;AACJ;;AAED,aAAS,OAAT,CAAiB,IAAjB,EAAuB,EAAvB,EAA2B;AACvB,YAAI,SAAS,QAAQ,KAAR,EAAe,GAAf,CAAb;;AAEA,eAAO,IAAP,CAAY,kCAAkC,EAAlC,GAAuC,SAAnD;AACA,WAAG,OAAH,CAAW,IAAX,EAAiB,UAAU,GAAV,EAAe,GAAf,EAAoB;AACjC,gBAAI,GAAJ,EAAS;AACL,uBAAO,IAAP,CAAY,OAAZ,EAAqB,GAArB;AACA;AACH;AACD,mBAAO,IAAP,CAAY,KAAK,SAAL,CAAe,GAAf,CAAZ;AACA,mBAAO,GAAP,CAAW,KAAX;AACH,SAPD;AAQA,eAAO,MAAP;;AAEA,iBAAS,KAAT,CAAgB,GAAhB,EAAqB,GAArB,EAA0B,IAA1B,EAAgC;AAC5B,iBAAK,IAAL,CAAU,GAAV;AACA;AACH;AACD,iBAAS,GAAT,CAAc,IAAd,EAAoB;AAChB,iBAAK,IAAL,CAAU,IAAV;AACA;AACH;AACJ;;AAED,aAAS,WAAT,CAAsB,IAAtB,EAA4B;AACxB,YAAI,SAAS,QAAQ,KAAR,EAAe,GAAf,CAAb;AACA,WAAG,OAAH,CAAW,IAAX,EAAiB,UAAU,GAAV,EAAe,GAAf,EAAoB;AACjC,gBAAI,GAAJ,EAAS;AACL,uBAAO,IAAP,CAAY,OAAZ,EAAqB,GAArB;AACA;AACH;AACD,mBAAO,GAAP,CAAW,KAAK,SAAL,CAAe,GAAf,CAAX;AACH,SAND;AAOA,eAAO,MAAP;;AAEA,iBAAS,KAAT,CAAgB,GAAhB,EAAqB,GAArB,EAA0B,IAA1B,EAAgC;AAC5B,iBAAK,IAAL,CAAU,GAAV;AACA;AACH;AACD,iBAAS,GAAT,CAAc,IAAd,EAAoB;AAChB,iBAAK,IAAL,CAAU,IAAV;AACA;AACH;AACJ;AACJ,CA1ID","file":"index-compiled.js","sourcesContent":["var staticModule = require('static-module');\nvar quote = require('quote-stream');\nvar through = require('through2');\nvar fs = require('fs');\nvar path = require('path');\nvar resolve = require('resolve');\n\nmodule.exports = function (file, opts) {\n    if (/\\.json$/.test(file)) return through();\n    \n    function resolver (p) {\n        return resolve.sync(p, { basedir: path.dirname(file) });\n    }\n    var vars = {\n        __filename: file,\n        __dirname: path.dirname(file),\n        require: { resolve: resolver }\n    };\n    if (!opts) opts = {};\n    if (opts.vars) Object.keys(opts.vars).forEach(function (key) {\n        vars[key] = opts.vars[key];\n    });\n    \n    var sm = staticModule(\n        {\n            fs: {\n                readFileSync: readFileSync,\n                readFile: readFile,\n                readdirSync: readdirSync,\n                readdir: readdir\n            }\n        },\n        { vars: vars, varModules: { path: path } }\n    );\n    return sm;\n    \n    function readFile (file, enc, cb) {\n        if (typeof enc === 'function') {\n            cb = enc;\n            enc = null;\n        }\n        if (enc && typeof enc === 'object' && enc.encoding) {\n            enc = enc.encoding;\n        }\n        var isBuffer = false;\n        if (enc === null || enc === undefined) {\n            isBuffer = true;\n            enc = 'base64';\n        }\n        \n        var stream = through(write, end);\n        stream.push('process.nextTick(function(){(' + cb + ')(null,');\n        if (isBuffer) stream.push('Buffer(');\n        \n        var s = fs.createReadStream(file, { encoding: enc });\n        s.on('error', function (err) { sm.emit('error', err) });\n        return s.pipe(quote()).pipe(stream);\n        \n        function write (buf, enc, next) {\n            this.push(buf);\n            next();\n        }\n        function end (next) {\n            if (isBuffer) this.push(',\"base64\")');\n            this.push(')})');\n            this.push(null);\n            sm.emit('file', file);\n            next()\n        }\n    }\n    \n    function readFileSync (file, enc) {\n        var isBuffer = false;\n        if (enc === null || enc === undefined) {\n            isBuffer = true;\n            enc = 'base64';\n        }\n        if (enc && typeof enc === 'object' && enc.encoding) {\n            enc = enc.encoding;\n        }\n        var stream = fs.createReadStream(file,  { encoding: enc })\n            .on('error', function (err) { sm.emit('error', err) })\n            .pipe(quote()).pipe(through(write, end))\n        ;\n        if (isBuffer) {\n            stream.push('Buffer(');\n        }\n        return stream;\n        \n        function write (buf, enc, next) {\n            this.push(buf);\n            next();\n        }\n        function end (next) {\n            if (isBuffer) this.push(',\"base64\")');\n            this.push(null);\n            sm.emit('file', file);\n            next();\n        }\n    }\n    \n    function readdir(path, cb) {\n        var stream = through(write, end);\n\n        stream.push('process.nextTick(function(){(' + cb + ')(null,');\n        fs.readdir(path, function (err, src) {\n            if (err) {\n                stream.emit('error', err);\n                return;\n            }\n            stream.push(JSON.stringify(src));\n            stream.end(')})');\n        });\n        return stream;\n\n        function write (buf, enc, next) {\n            this.push(buf);\n            next();\n        }\n        function end (next) {\n            this.push(null);\n            next();\n        }\n    }\n\n    function readdirSync (path) {\n        var stream = through(write, end);\n        fs.readdir(path, function (err, src) {\n            if (err) {\n                stream.emit('error', err);\n                return;\n            }\n            stream.end(JSON.stringify(src));\n        });\n        return stream;\n\n        function write (buf, enc, next) {\n            this.push(buf);\n            next();\n        }\n        function end (next) {\n            this.push(null);\n            next();\n        }\n    }\n};\n"]}