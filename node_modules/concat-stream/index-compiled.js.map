{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["var Writable = require('readable-stream').Writable\nvar inherits = require('inherits')\n\nif (typeof Uint8Array === 'undefined') {\n  var U8 = require('typedarray').Uint8Array\n} else {\n  var U8 = Uint8Array\n}\n\nfunction ConcatStream(opts, cb) {\n  if (!(this instanceof ConcatStream)) return new ConcatStream(opts, cb)\n\n  if (typeof opts === 'function') {\n    cb = opts\n    opts = {}\n  }\n  if (!opts) opts = {}\n\n  var encoding = opts.encoding\n  var shouldInferEncoding = false\n\n  if (!encoding) {\n    shouldInferEncoding = true\n  } else {\n    encoding =  String(encoding).toLowerCase()\n    if (encoding === 'u8' || encoding === 'uint8') {\n      encoding = 'uint8array'\n    }\n  }\n\n  Writable.call(this, { objectMode: true })\n\n  this.encoding = encoding\n  this.shouldInferEncoding = shouldInferEncoding\n\n  if (cb) this.on('finish', function () { cb(this.getBody()) })\n  this.body = []\n}\n\nmodule.exports = ConcatStream\ninherits(ConcatStream, Writable)\n\nConcatStream.prototype._write = function(chunk, enc, next) {\n  this.body.push(chunk)\n  next()\n}\n\nConcatStream.prototype.inferEncoding = function (buff) {\n  var firstBuffer = buff === undefined ? this.body[0] : buff;\n  if (Buffer.isBuffer(firstBuffer)) return 'buffer'\n  if (typeof Uint8Array !== 'undefined' && firstBuffer instanceof Uint8Array) return 'uint8array'\n  if (Array.isArray(firstBuffer)) return 'array'\n  if (typeof firstBuffer === 'string') return 'string'\n  if (Object.prototype.toString.call(firstBuffer) === \"[object Object]\") return 'object'\n  return 'buffer'\n}\n\nConcatStream.prototype.getBody = function () {\n  if (!this.encoding && this.body.length === 0) return []\n  if (this.shouldInferEncoding) this.encoding = this.inferEncoding()\n  if (this.encoding === 'array') return arrayConcat(this.body)\n  if (this.encoding === 'string') return stringConcat(this.body)\n  if (this.encoding === 'buffer') return bufferConcat(this.body)\n  if (this.encoding === 'uint8array') return u8Concat(this.body)\n  return this.body\n}\n\nvar isArray = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]'\n}\n\nfunction isArrayish (arr) {\n  return /Array\\]$/.test(Object.prototype.toString.call(arr))\n}\n\nfunction stringConcat (parts) {\n  var strings = []\n  var needsToString = false\n  for (var i = 0; i < parts.length; i++) {\n    var p = parts[i]\n    if (typeof p === 'string') {\n      strings.push(p)\n    } else if (Buffer.isBuffer(p)) {\n      strings.push(p)\n    } else {\n      strings.push(Buffer(p))\n    }\n  }\n  if (Buffer.isBuffer(parts[0])) {\n    strings = Buffer.concat(strings)\n    strings = strings.toString('utf8')\n  } else {\n    strings = strings.join('')\n  }\n  return strings\n}\n\nfunction bufferConcat (parts) {\n  var bufs = []\n  for (var i = 0; i < parts.length; i++) {\n    var p = parts[i]\n    if (Buffer.isBuffer(p)) {\n      bufs.push(p)\n    } else if (typeof p === 'string' || isArrayish(p)\n    || (p && typeof p.subarray === 'function')) {\n      bufs.push(Buffer(p))\n    } else bufs.push(Buffer(String(p)))\n  }\n  return Buffer.concat(bufs)\n}\n\nfunction arrayConcat (parts) {\n  var res = []\n  for (var i = 0; i < parts.length; i++) {\n    res.push.apply(res, parts[i])\n  }\n  return res\n}\n\nfunction u8Concat (parts) {\n  var len = 0\n  for (var i = 0; i < parts.length; i++) {\n    if (typeof parts[i] === 'string') {\n      parts[i] = Buffer(parts[i])\n    }\n    len += parts[i].length\n  }\n  var u8 = new U8(len)\n  for (var i = 0, offset = 0; i < parts.length; i++) {\n    var part = parts[i]\n    for (var j = 0; j < part.length; j++) {\n      u8[offset++] = part[j]\n    }\n  }\n  return u8\n}\n"]}